eval "local count = redis.call('zcount', 'movie.budget.index', '-inf', '+inf'); local sum = 0; local z = redis.call('zrange', 'movie.budget.index', 0, -1, 'WITHSCORES'); for i=2, #z, 2 do sum = sum+z[i] end; local avg_budget = sum/count; redis.call('zrangestore', 'highbudget', 'movie.budget.index', avg_budget, 'inf', 'BYSCORE'); return redis.call('sort', 'highbudget', 'by', '*->rating', 'get', '*->name');" 0